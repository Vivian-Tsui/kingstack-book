# 10. 监控服务 {#10}

金山私有云监控服务提供对云主机、物理机和交换机的性能监控查看和服务监控查看。

## 10.1 监控模板 {#10-1}

监控模版是指某种云资源的监控项目集合。比如云主机的监控模版可以是CPU使用率、内存使用率、网卡流量、磁盘I/O的监控项集合。租户可以指定一个监控模板，并将此模板与对应的云资源绑定。之后云平台便将会根据模板中包含的监控项对此资源进行监控，采集监控数据并展示在控制台上。

此外，金山私有云平台向用户提供自建监控模板的功能，创建模板时可以选择一个或多个监控项，并且可以为每个选定的监控项设置报警规则，当资源使用率达到报警上限时就会向用户发送报警信息。模板分为两种类型public和private。public类型的模板对所有tenant可见，private类型的模板仅属于特定的tenant，tenant之间不可见。详细的操作权限说明如下：


| 角色名称 | 创建/复制 | 删除 | 更新 | 查看 |
| :--- | | :--- | | :--- | | :--- | | :---| 
| Admin<br>/Serviceadmin<br>/Maintenanceadmin | Public、Private | Public、Private | Public、Private | Public、Private |
| 项目 Owner | Private | Private | Private | Public、Private |
| 项目 Member | -- | -- | -- | Public、Private |

其他注意事项如下：

1. 为被监控主机（物理机、交换机或虚拟机）创建监控时，提供可选模板列表，并且仅能选择一个模板。
2. 修改监控模板的监控项、trigger时，联动修改主机的监控信息；删除模板时不影响关联的主机。
3. 金山私有云平台自带的默认监控模板包含全量监控项，但是不包含报警规则。并且只能对它复制，不能进行修改、删除等其他操作。

### 10.1.1 创建监控模板 {#10-1-1}

1. 以admin或者maintenanceadmin账户登录控制台，建议采用后者。
2. 点击左侧导航条中的“监控 -> 监控模板“，在云主机监控模板页面下，点击“创建监控模板”，在弹出的输入框中输入模板名称、描述、并勾选“设为Public模板”（不勾选则模板为private类型），创建云主机监控模板。

   ![](/assets/创建监控模板-Admin.png)


### 10.1.2 管理监控项 {#10-1-2}

1. 在云主机监控模板页面，选中某个监控模板，点击右侧的  ![](/assets/icon-more.png)  按钮，选择“管理监控项”。
2. 在弹出的页面中选择监控项，然后点击“确定”。

   ![](/assets/管理监控项弹窗.png)
   
### 10.1.3 设置报警规则 {#10-1-3}

1. 在云主机监控模板页面，选中某个监控模板，点击右侧的 ![](/assets/icon-more.png) 按钮，选择“设定报警规则”。
2. 在弹出的页面中设置报警规则。对每个监控项都可以设置报警规则，用户可以根据情况自行设定。当资源使用率达到报警上限及持续时间时就会向用户发送报警信息。
   
   ![](/assets/设置报警规则.png)
   
### 10.1.4 更多操作

除管理监控项、设置报警规则外，每个监控模板的右侧还提供了更多其他操作的入口，包括编辑模板、删除模板、复制模板。

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑模板 | ![](/assets/icon-edit.png) | -- | 修改监控模板的名称、描述信息、public/private类型 |
| 删除模板 | ![](/assets/icon-delete.png) | 监控模板上已经没有绑定的云资源 | 模板下有绑定的云资源时不允许删除 |
| 复制模板 | ![](/assets/icon-more.png) | 复制模板命名时不可与已有监控模板重名 | 复制模板时将复制已有模板的监控项和报警规则 |
   
