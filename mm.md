# 9. 管理（仅管理员） {#9}

金山私有云上的资源（主机、存储、路由、网络等）是以项目为单位进行管理的。

对每一个项目，可以添加多个用户，项目中的用户可以共享项目内的所有资源。但不同角色的用户拥有的权限不同，在此重复一下上文提到的角色权限说明： 

| 角色名称 | 角色说明 |
| :--- | | :--- | 
| Admin | 云平台的超级管理员，拥有全部权限。建议开放给少数人使用。|
| Serviceadmin | 云平台的业务管理员，负责管理云资源、云租户、计费、审批等。|
| Maintenanceadmin | 云平台的运维管理员，负责管理云平台软件、底层物理硬件以及资源的上下线。 |
| 项目 Owner | 租户管理员，拥有一个项目内的所有权限，包括创建虚拟网络、云主机、云硬盘。拥有审批权限。 |
| 项目 Member | 租户成员，权限受限，不能够创建虚拟网络，只能够使用弹性IP、创建云主机和云硬盘。 |

## 9.1 用户管理 {#9-1}

### 9.1.1 查看用户 {#9-1-1}

管理员Admin登录控制台后，选择左侧导航栏“管理->用户管理”，可查看云平台上所有项目的所有用户，用户信息包括：用户名、手机、电子邮件、启用、角色、项目和描述。

* 用户名：用户登录金山私有云时使用的名字。
* 手机：用户的手机号码。
* 电子邮件：用户的邮件地址，格式为name@mail.com.
* 启用：表示该用户当前是否可以登录系统，“是”表示可以。
* 角色：表示该用户所拥有的权限，admin、serviceadmin、maintenanceadmin、owner、member。
* 项目：用户所属的项目组。
* 描述：描述信息，用于说明或备注。

此外，可根据用户名、邮箱、手机号和所属项目对用户进行精确搜索。

### 9.1.2 创建用户 {#9-1-2}

点击用户管理列表右上角的“创建用户”按钮，在弹出的输入框中填写用户名、密码、描述、手机号码、电子邮件，并且选择用户所属的项目和拥有的权限（owner或member），最后点击“创建”完成用户添加。

![](/assets/创建用户.png)

### 9.1.3 更多操作 {#9-1-3}

“更多操作”下拉框位于用户管理列表的右上角，提供的操作有：更新用户、更改密码和删除用户。

| 操作 | 描述 |
| :--- | | :--- |
| 更新用户 | 可修改该用户的用户名、描述、电子邮件、手机号码和启用状态。|
| 更改密码 | 可为该用户设置新密码，注意两次密码输入必须一致。|
| 删除用户 | 弹窗提示是否确定要删除该用户，点击“删除”完成删除操作。|

## 9.2 项目管理 {#9-2}

### 9.2.1 查看项目 {#9-2-1}

管理员可登录控制台查看云平台上所有的项目：

1. 登录控制台，点击左侧导航栏“管理->项目管理”，即可查看私有云上所有的项目，项目列表中显示项目的名称、启用、项目标识和资源池。

  * 名称：项目的名字，由管理员创建时填写。
  * 启用：表示该项目当前是否启用，项目状态为“未启用”时，此项目组中的所有用户均无法登录系统、项目组中的所有资源均无法访问。
  * 项目标识：项目的唯一标识号。
  * 资源池：项目绑定的资源池名称，一个项目至少要与一个资源池绑定。
  
2. 点击项目名称，可查看该项目的详细信息，包括：项目描述、项目成员和配额管理。
   
   * 项目概述：显示该项目的名称、项目标识、状态及资源池信息，并且可以在此进行“绑定资源池”和“解绑资源池”操作。
   
    ![](/assets/项目管理-项目概述.png)

   * 项目成员：显示该项目组下的用户列表，包括用户名称和用户角色。
   
    ![](/assets/项目管理-项目成员.png)
    
    选中某个成员，可为该用户重新分配角色，可选的用户角色有两种，owner和member。
    
    ![](/assets/项目管理-分配角色.png)
    
   * 配额管理：显示该项目组的资源使用情况，资源类型包括计算资源、网络资源、安全组和存储资源，可以在此增加或是减少项目配额（当鼠标悬浮至具体的资源条目上时，该资源配额后方将出现编辑图标，点击即可编辑资源配额）。

    ![](/assets/项目管理-配额管理.png)

### 9.2.2 创建项目 {#9-2-2}

选择左侧导航栏的“管理->项目管理”列表，点击右侧牙面右上角的“创建项目”按钮，弹出创建项目窗口，填写项目名称，选择要绑定的资源池，勾选启用，点击“创建项目”完成创建。

每个项目至少要绑定1个资源池，最多可绑定5个资源池。

![](/assets/项目管理-创建项目.png)

### 9.2.3 更多操作 {#9-2-3}

点击项目管理列表每个项目的右侧都有更多操作，可选择编辑项目、删除项目或绑定解绑资源池操作。

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑名称 | ![](/assets/icon-edit.png) | -- | 修改项目的名称 |
| 删除项目 | ![](/assets/icon-delete.png) | 项目下无已分配的云资源 | 项目下面有绑定的资源池时不允许删除 |
| 绑定资源池 | ![](/assets/icon-more.png) | 项目绑定的资源池数未超过5个 | 每个项目最多能同时绑定5个资源池。 |
| 解绑资源池 | ![](/assets/icon-more.png) | 资源池下面没有分配资源 | 待解绑的资源池下面不能有分配资源，否则解绑失败。 |

## 9.3 存储管理 {#9-3}

金山云私有云集群将底层的存储细节结构化展示给用户，在用户控制台界面实现存储后端的灵活安装、配置、添加及管理。且相关配置不依赖于配置文件，能够实现水平扩展。 存储的安装过程充分自动化，不需要手动操作。（详见4云存储服务）

### 9.3.1 磁盘列表 {#9-3-1}

点击左侧菜单栏的“管理->存储管理”，进入存储管理页面，点击“磁盘列表”选项卡即可查看磁盘列表，列表中展示的信息包括：磁盘盘符、所属物理机、挂载目录、大小、使用率、类型、状态、组ID和存储进程端口。

在此页面可探测出物理机集群的磁盘。探测方式分为“探测集群磁盘”和“探测物理机磁盘”两种。其中“探测集群磁盘”按钮是一次性探测出物理机集群的所有磁盘，“探测物理机磁盘”可选择不同的物理机进行探测。

![](/assets/存储管理-探测磁盘.png)

针对磁盘的操作包括编辑和删除：

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑磁盘 | ![](/assets/icon-edit.png) | 磁盘处于可用状态 | 更改磁盘类型 |
| 删除磁盘 | ![](/assets/icon-delete.png) | 磁盘处于可用状态 | 正在使用状态下的磁盘不可删除 |

### 9.3.2 存储集群 {#9-3-2}

点击左侧菜单栏的“管理->存储管理”，进入存储管理页面，点击“存储集群”选项卡即可查看存储集群列表，列表中展示的信息包括：名称、描述、磁盘数量、网关端口、集群类型、状态、启/禁用状态，及创建时间。

#### 9.3.2.1 创建存储集群 {#9-3-2-1}

点击页面右上方“创建存储集群”按钮，在弹出的输入框中输入名称、描述、选择类型（sata/ssd/sas），最后点击“确定”按钮，创建存储集群。

![](/assets/存储管理-创建存储集群.png)

#### 9.3.2.2 扩展存储集群 {#9-3-2-2}

点击右侧“扩容”，弹出框中会列出探测到的同类型（sata/ssd/sas）磁盘，用户可在左侧下拉列表中勾选，并且在右侧“已选磁盘”中点击删除按钮可移除不想选的磁盘。但是之前已经添加成功的磁盘无法在此删除。

![](/assets/存储管理-扩容.png)

#### 9.3.2.3 启用/禁用集群 {#9-3-2-3}

点击列表右侧的“启用/禁用”功能链接，可启用/禁用存储集群。

启用存储集群时，需选择启用后要上架的卷类型产品:

![](/assets/存储集群-启用-上架产品.png)

禁用存储集群时，如果集群为默认集群，则禁用按钮不可点击。


#### 9.3.2.4 其他操作 {#9-3-2-4}

| 操作 | 对应按钮 | 前提条件 | 描述 |
| :--- | | :--- | | :--- | | :--- |
| 编辑集群 | ![](/assets/icon-edit.png) | 磁盘处于可用状态 | 更改磁盘类型 |
| 删除集群 | ![](/assets/icon-delete.png) | 集群处于启用状态、集群上没有数据且不是默认集群 | 处于禁用状态的集群不可删除，默认集群也不可删除，如果集群上有数据，则删除失败 |
| 设为默认集群 | 设为默认 | -- | 设为默认集群后，该集群不可禁用，也不可删除 |

## 9.4 节点部署管理 {#9-4}

### 9.4.1 背景知识 {#9-4-1}

管理员可通过“节点部署管理”进行KingStack云环境的部署安装。KingStack的节点可分为一下类型：

| 节点类型 | 功能说明 | 安装部署方式 |
| :--- | |:--- | | :--- |
| 控制节点 | 云平台的全部管理组件都部署在控制节点 | 通过自动化脚本安装 |
| 计算节点 | 计算节点用于部署计算虚拟化的相关组件 | 依靠图形化界面安装部署 |
| 存储节点 | 存储节点用于部署分布式存储的相关组件 | 依靠图形化界面安装部署 |
| 网络节点 | 网络节点用于部署Neutron等网络的相关组件 | 依靠图形化界面安装部署 |

### 9.4.2 操作步骤 {#9-4-2}

点击左侧菜单栏的“管理->节点部署管理”，进入节点部署页面，该页面包含了两部分：部署服务器和节点列表。

在部署服务部分

1. 将部署服务器由“Down”状态设置为“Active”状态。
2. 添加裸机节点。点击列表右上角的“添加节点”按钮，在弹出框中填写节点名称、IPMI接口信息以及管理IP等信息。完毕后，点击“确认”提交。
3. 安装系统。点击具体节点右侧的“安装OS”功能链接，为物理节点安装系统。
4. 配置网络。点击具体节点右侧的“配置网络”功能链接，可在弹出框中执行发现网卡、编辑网卡信息和配置bond的操作。当已为节点指定角色并完成部署后，“配置网络”功能将禁用不可点击。
5. 指定节点角色。在节点列表中选定指定的节点，点击“部署节点”。在弹出框中勾选节点类型，同时填写节点的网卡信息以及存储网络信息。

### 9.4.3 其他操作 {#9-4-3}

| 操作 | 前提条件 | 描述 |
| :--- | | :--- | | :--- |
| 关机 | 物理节点处于开机状态 | 关闭物理节点 | 
| 开机 | 物理节点处于关机状态 | 开启物理机节点 |
| 重启 | -- | 重新启动物理节点 |
| 重装系统 | 仅“已安装OS”状态下的物理节点可执行重装系统操作 | 只有当物理节点已安装OS，但尚未部署角色时才可重装物理节点的系统 |
| 删除 | 仅“未安装OS”和“已安装OS”两种状态下的物理节点可执行删除操作 | 删除物理节点 |
| 卸载计算节点 | 为物理节点部署了计算节点角色 | 卸载节点上已经部署好的计算虚拟化相关组件 |
| 卸载网络节点 | 为物理节点部署了网络节点角色 | 卸载节点上已经部署好的网络相关组件 |

### 9.4.4 节点详情 {#9-4-4}

在节点列表中点击节点名称可进入节点详情页，查看节点的详细配置信息：

1. 基本信息：该部分信息适用于所有角色的物理节点，列出了物理节点的基本配置信息，包括名称、状态、 IP地址等，以及网卡列表和Bond列表。
2. 计算资源：该部分信息适用于部署了计算节点角色的物理节点，列出了计算资源的使用情况，以及物理节点上的云主机信息，管理员还可在这里执行云主机迁移操作。
3. 网络资源：该部分信息适用于部署了网络节点角色的物理节点，列出了物理节点上的网络资源信息，包括网络、路由器、负载均衡等。
4. 监控：该部分信息适用于所有角色的物理节点，展示了物理节点的监控信息，包括性能监控、服务监控和报警规则。

## 9.5 计算节点管理 {#9-5}

管理员可通过“计算节点管理”查看所有的物理机资源，包括预上线资源池和已上线资源池中的计算节点，以及这些计算节点当前的状态和使用情况。管理员可以创建新的资源池，向资源池中添加计算节点。 

### 9.5.1 资源池列表 {#9-5-1}

资源池列表展示了当前已有资源池的相关信息，包括资源池名称、所属网络分区、资源池中物理机的数量、静态调试策略、CPU复用比、RAM复用比、创建时间。

预上线资源池永远位于资源池列表中的第一列。

### 9.5.2 创建资源池 {#9-5-2}

点击页面右上方“添加资源池”按钮，在弹窗中填写资源池的名字、静态调度策略、CPU复用比以及RAM复用比，添加网络区域，之后点击“确定”完成创建。成功后可在资源池列表中查看到。

![](/assets/创建资源池.png)

CPU复用比：是指物理核与虚拟核的资源复用比例。数值越大代表单核物理CPU可虚拟出的虚拟CPU越多。
RAM复用比：是指物理内存与虚拟内存的资源复用比例。数值越大代表单位物理内存可虚拟出的虚拟内存越多。

### 9.5.3 计算节点列表 {#9-5-3}





















