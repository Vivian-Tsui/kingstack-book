# 3. 云主机服务 {#3}

云主机是金山私有云平台提供的一种基础云计算服务，并提供对云主机的整个生命周期的管理。

云主机实例是通过虚拟化方式创建出来的虚拟机资源，它拥有自己独立的操作系统，包含了CPU、内存、操作系统、磁盘、带宽等最基础的服务器组件。

一个实例就等同于一台虚拟机，您对所创建的实例可以随时登录进行使用和管理，并可以在实例上进行基本操作，如：迁移、创建镜像、创建快照、创建监控等。

主要功能列表如下：

| 功能 | 说明 |
| :--- | :--- |
| 创建云主机 | 前置条件：有虚拟网络可选<br/>若没有，请先创建虚拟网络，参见`网络管理` |
| 运行、重启、停止 | -- |
| 更改云主机配置 | 关机状态下操作 |
| 迁移 | 在线迁移 |
| 创建镜像 | 关机状态下操作 |
| 创建快照 | 关机状态下操作 |
| 重置密码 | 关机状态下操作 |
| 创建、修改、删除监控 | -- |
| 删除云主机 | -- |

## 3.1 云主机管理 {#3-1}

### 3.1.1 创建云主机 {#3-1-1}

金山私有云平台提供向导的方式帮助用户进行云主机的创建。

#### 配置选项：

* 通用配置

| 选项 | 说明 |
| :--- | :--- |
| 主机名称 | 云主机的名字<br/>若系统为linux，则写入为操作系统的Hostname |
| 主机数量 | 默认为1<br/>若大于1将批量创建对应数量的同规格云主机 |
| 资源池（可自动分配） | 所创建云主机所属的资源池 |
| 系统镜像 | 包含通用镜像和自定义镜像 |
| 主机配置 | 包含CPU、内存、硬盘，可根据需求灵活定制 |
| 安全组 | 默认选择平台default安全组<br/>如需自定义参见`网络管理` |
| 选择网络 | 前置条件：有虚拟网络可选 |
| 选择网卡子网 | 可添加扩展网卡，上限为5块 |

* 可选配置

| 选项 | 说明 |
| :--- | :--- |
| 登录方式 | 默认为密码登录<br/>勾选后采用证书登录(SSH密钥) |
| 主机组 | 选择后云平台调度系统会将此主机组内的云主机分布于不同的物理主机 |
| 选择GPU | 为云主机增加GPU<br/>包括GPU的型号、数量及物理机的选择 |

#### 创建云主机实例步骤：

1. 登录金山私有云平台，点击左侧导航条中的`云主机` -> `云主机管理`，在右侧云主机管理页面，点击`创建云主机`。
2. 第一步：基本配置
![image](/assets/创建云主机表单-1.png)
3. 第二步：选择GPU（可选）
![](/assets/创建云主机表单-2.png)
4. 第三步：选择镜像
![](/assets/创建云主机表单-3.png)
5. 第四步：主机配置
![](/assets/创建云主机表单-4.png)
6. 第五步：网络设置
![](/assets/创建云主机表单-5.png)
7. 点击`创建`按钮，完成创建云主机流程。所创建实例将在`云主机列表`中显示，用户可对云主机进行更多操作。

### 3.1.2 查看云主机 {#3-1-2}

#### 列表查看

登录金山私有云平台，点击左侧导航条中的`云主机` -> `云主机管理`。

右侧云主机管理主界面会以列表的方式列出在当前项目下的所有云主机。

页面的右上角列出对云主机的三项基本操作`运行`、`停止`和`创建`方便用户对云主机的快捷操作，`更多操作`收录了云主机相关的其他操作。 

在云主机列表中每一行显示云主机的相关信息包括名称，状态，IP地址，是否处于监控中，操作系统类型，所属网络区域，所属资源池（可按资源池对主机进行筛选），云主机的创建时间（支持按创建时间对主机进行正向或逆向排序），以及云主机的所属项目和用户。

#### 详情查看

点击指定的云主机名字会进入云主机的详细页面，包括云主机的基本信息、磁盘管理、监控。在页面右上角可以进行主机的开/关机和重启操作。为方便理解，这里选上一步新建的虚机`VM-test`。

![](/assets/云主机-详情-基本信息.png)

##### 基本信息

基本信息页面分为基本信息和网络信息两部分。

- 基本信息左侧一栏显示当前云主机的名称及UUID、云主机位置信息（资源池和物理机节点）、创建时间、状态和订单信息；右侧一栏显示当前云主机绑定证书、所属主机组、镜像信息、和云主机规格（CPU、内存、磁盘等），并可以打开控制台。右上角`更多操作`按钮可对当前云主机进行相关操作。

- 网络信息为云主机多网卡信息显示，可以进行网卡的添加和删除操作（单台云主机当前网络下做多可添加5块网卡）。并以列表形式分别显示不同网卡的固定IP、浮动IP、虚拟IP、所属网络、所属分区、关联子网和安全组。

##### 磁盘管理

磁盘管理页面显示此云主机拥有的所有磁盘信息（包括磁盘名称、状态、大小和创建时间）。选中某一特定磁盘可对其进行`创建快照`操作，快照可以保留某个时间点上的系统数据状态，用于数据备份及回滚操作。

创建快照注意事项：
1. 避开业务高峰。创建快照可能会轻微降低磁盘的性能，出现短暂瞬间变慢。
2. 实例状态必须为运行中或已关闭。
3. 手动创建的快照会一直保留。如不再需要，请手动删除。

##### 云主机监控

云主机监控页面显示此云主机各个监控项的实时监控信息，并且可以选择“1天”、“7天”不同时间类别的监控信息。

### 3.1.3 自定义镜像 {#3-1-3}

用户在创建云主机后可以登录云主机安装应用软件以及把业务应用部署到云主机上，此时用户可以通过金山私有云平台的制作自定义镜像功能把现有的云主机转换成镜像，方便以后直接用镜像进行新的云主机部署。*（注意，此功能要求云主机在关机状态。）*

#### 创建自定义镜像操作步骤

1. 在`云主机管理`列表中选中云主机（或进入所选`云主机详情`页面），点击`更多操作`按钮，在操作列表中点击`创建镜像`。









































